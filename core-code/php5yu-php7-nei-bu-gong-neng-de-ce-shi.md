# PHP5与PHP7内部功能的测试

> 使用.phpt文件进行测试 , 在PHP源码中的run-tests是PHP定制黑盒测试工具 .

### 测试概述

PHP有一个广泛的测试套件 , 有超过1.5万单独的测试文件 . 测试文件运行的是PHP的黑盒测试工具run-tests.php , 它可以在PHP源代码的根目录中找到 . 

但是 , PHP源码没有任何单元测试 , 但它确实有功能测试 , 而且这些特定的功能测试是用PHP编写的 , 测试文件的扩展名是.phpt后缀的, 可以像任何正常的PHP文件一样运行 . 

> 编写phpt测试的官方说明在http://qa.php.net/write-test.php

#### 黑盒测试

简而言之 , 黑盒测试就是向某些函数发送输入 , 并在函数完成执行后检查输出 . 如果输出与我们预期的匹配 , 则测试已通过 . 黑盒测试不关心如何做的事情 , 它只关心最终的结果 . 这正是 run-tests 的工作原理 . 它需要一组输入 , 运行一些 PHP 代码 , 然后检查输出 . 如果输出与预期的匹配 , 则测试通过 . 

#### 测试文件所在的位置

测试文件在名为tests的文件夹中 , 在基本代码的目录中都会找到tests目录 . 里面都是phpt文件相关的 . 

* ext/{extension-name}/tests/  - 扩展测试
* sapi/{sapi-name}/tests/ - SAPI测试
* Zend/tests/ Zend引擎测试
* tests/ 更多Zend引擎测试

---

### 运行测试套件

现在我们对正在做的测试有了一个基本的了解 , 让我们来运行测试套件 . 在运行测试之前 , 确保已经从源代码中成功地构建了php , 并且在sapi/cli/php中有一个可执行文件 . 

运行测试套件有两种方法 : 

#### 使用 run-tests 直接运行测试

可以直接使用 run-tests. php 来运行测试套件 . 至少 , 需要指定希望测试的php可执行文件 , 可以使用 -p 标志来执行 . 注意 , 为了正确运行所有测试 , 需要使用PHP可执行文件的绝对路径 . 



