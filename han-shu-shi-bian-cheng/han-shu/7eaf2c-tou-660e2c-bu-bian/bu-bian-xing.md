# 不变性

#### Immutability

我们说一个变量应该是不可变的 , 如果它被赋值后 , 你就不能改变它的内容 . 在函数的纯度之后 , 函数式编程第二个最重要的事情 .

在一些学术语言中 , 你会听到 : 你不能声明变量 , 一切都必须是一个函数 . 因为所有这些函数都是纯的 , 这意味着其有天然的不变性 . 其中一些语言提供了类似于变量声明的语法糖 , 以避免总是声明函数的潜在问题 .

大多数函数式语言只允许您声明为同一目的服务的不可变变量或构造 . 这意味着您有一种存储值的方法 , 但在初始赋值之后 , 不可能更改数值 . 还有一些语言可以让你为每个变量选择你想要的 . 例如 , 在 Scala 中, 您有 var 关键字来声明传统可变变量和 val 关键字来声明不可变变量 .

然而大多数语言 , 如 PHP 的情况一样 , 没有变量的不变性概念 .

#### 为什么不变性很重要？

首先 , 它有助于减少认知负担 . 要记住算法中涉及的所有变量已经相当困难了 . 如果没有不变性 , 您还需要记住所有的值更改 . 将一个值与特定的标签\(即变量名\)关联起来要容易得多 . 如果你能确定这个值不会改变 , 那么对正在发生的事情进行推理就容易多了 .

另外 , 如果有一些全局的状态你无法摆脱 , 只要它是不可变的 , 就可以记录这些变量的值 , 因为无论在程序执行过程中发生什么 , 所写的总是程序的当前状态 , 这意味着不必启动调试器或输出变量来确保值没有改变 .

假设将一个对象传递给一个函数 . 但不知道函数是否是纯的 , 这意味着可以更改对象属性 . 其在你的头脑中引入了烦恼 , 并分散了你的思维 . 事实上 , 你必须问自己 , 是否内部状态发生了变化 , 从而降低了对代码进行推理的能力 . 如果你的对象是不可变的 , 你可以得到100%的保证 , 它完全和以前一样 , 加速你对正在发生的事情的理解 . 

您还有与线程安全和并行化相关的优势 . 如果您的所有状态都是不可变的 , 则更容易确保您的程序能够同时在多个内核或计算机上运行 . 大多数并发问题都是由于某个线程修改了一个值而没有与其他线程进行正确同步而发生的 . 这会导致它们之间的不一致 , 而且通常是计算中的错误 . 如果您的变量是不可变的 , 只要所有线程都被发送相同的数据 , 这种情况就不太可能发生 , 当然 , 这并不真正有用 , 因为 PHP 主要用于非线程方案 . 

