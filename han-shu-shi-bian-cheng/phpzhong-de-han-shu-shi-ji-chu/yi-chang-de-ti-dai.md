# 异常的替代

正如我们刚才所看到的, 如果我们想保持代码的纯净, 就不能使用异常。我们的选择是什么, 以确保我们可以表示一个错误的调用者我们的功能？我们希望我们的解决方案具有以下功能:

* 强制执行错误管理, 以便没有任何错误可以冒泡到最终用户
* 避免样板或复杂的代码结构
* 在我们的功能签名中发布
* 避免将错误误以为正确结果的风险

在本章下一节介绍一种具有所有这些优势的解决方案之前，我们来看看各种方法，在命令式语言中进行错误管理。

为了测试各种方法，我们将尝试实现我们早已使用的max函数：

```php
<?php
function max2(array $data): int
{
    return array_reduce($data, function(int $max, int $i) : int 
    {
        return $i > $max ? $i : $max;
    }, 0);
}
```

因为我们选择了初始值0 , 如果我们使用一个空数组调用函数 , 我们将得到结果0.是否真的是一个空数组的最大值 ? 如果我们调用与PHP自带的函数 , max\(\[\]\)方法会发生什么 ? 

> Warning: max\(\): Array must contain at least one element

此外，返回值false。 我们的版本使用值0作为默认值，我们可以将false视为错误代码。 PHP版本还会向您发出警告。

现在我们可以改进这个函数 , 让我们尝试我们拥有的各种选择 , 从最坏的到最好的 . 

