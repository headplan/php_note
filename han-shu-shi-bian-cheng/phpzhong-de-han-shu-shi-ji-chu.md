# PHP中的函数式基础

在第一章介绍了 PHP 中的函数的用法 , 第二章是函数式编程的理论方面 , 现在我们将开始编写真正的代码了 . 我们将从PHP中的可用函数开始 , 它允许我们编写函数式代码 . 一旦基本技术得到了很好的理解 , 我们将会转到各种类包中 , 这将帮助我们贯穿后面的所有内容 .

本章将介绍以下主题 :

* 映射、折叠、减少和压缩递归
* 异常为何会中断引用透明度
* 使用可能和任一类型处理错误的更好方法
* 可用于 PHP 的功能库

#### **一些建议**

在前几章中 , 我们描述了函数式应用程序必须具有的重要属性 . 但是 , 我们从未真正讨论过如何实现 . 除了我们稍后将会了解的各种技术外 , 还有一些简单的建议可以帮助您 .

**使所有输入显式**

我们讨论了纯度和隐藏的输入 , 或侧面的原因等很多在前一章 . 现在 , 应该非常清楚 , 所有函数的依赖项都应作为参数传递 . 然而, 这一建议更进一步 . 

避免将对象或复杂数据结构传递给您的函数 . 尝试将输入限制为只需要的内容 . 这样做将使您的函数的范围更容易理解 , 并可以轻松确定函数的运行方式 . 它还具有以下优点 : 

* 这将更容易调用
* 测试它将需要少量数据

**避免临时变量**

正如你看到的 , 变量的声明是邪恶的 , 特别是全局变量 . 但是 , 局部变量是一种局部状态 . 一旦你开始用他们弄脏你的代码 , 你正在慢慢打开蠕虫的罐头 . 在 PHP 这样的语言中尤其如此 , 所有变量都是可变的 . 如果值在一路变化 , 会发生什么？

每当你声明一个变量时 , 如果要了解其余的代码是如何工作的 , 你必须保持其值 . 这大大增加了认知负担 . 另外 , 由于PHP是动态类型的 , 所以变量可以重复使用完全不同的数据 . 

当使用一个临时变量 , 它总是会以某种方式修改或不是显示的 , 导致难以调试的错误和重复使用的风险 . 

在几乎所有情况下 , 使用函数优于临时变量 . 函数式有同样的好处 : 

* 通过命名中间结果提高可读性
* 避免重复自己
* 缓存冗长操作的结果\(这种需求需要使用前面提到的记忆化特性 , 后面性能优势时再做讨论\)

调用函数的附加开销通常是最小的 , 不足以影响其他 . 此外 , 使用函数代替临时变量意味着您可以在其他地方重用这些函数 . 它们还可以使将来的重构变得更容易 , 并改善对问题的分离 . 

但是 , 在最佳实践中可以预期 , 有时使用临时变量会更容易一些 . 例如 , 如果您需要存储一个将在短函数中使用的返回值 , 以便您可以保持行长美观性 , 请不要犹豫 . 唯一应该严格禁止的事情是使用相同的临时变量来存储不同的信息位 . 

**较小的函数**

**参数顺序问题**

